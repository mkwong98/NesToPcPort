#pragma once
#include <SDL3/SDL.h>
#include <vector>

class console;
class mapper;

struct stackEntry {
	bool isPC;
	Uint16 value;
};

struct callStackEntry {
	bool isManual;
	Uint16 value;
};

class game
{
public:
	console* myConsole;
	mapper* myMapper;
	Uint8 a;
	Uint8 x;
	Uint8 y;
	Uint8 s;
	bool flgC;
	bool flgZ;
	bool flgI;
	bool flgD;
	bool flgV;
	bool flgN;
	bool flgB;
	stackEntry poppedEntry;
	callStackEntry poppedStackEntry;
	Uint32 threadSignal;
	Uint32 pushedAddress;
	bool gameEnded;

	game();
	void initGame();
	void endGame();
	Uint8 getStatus();
	void setStatus(Uint8 p);
	void opADC(Uint8 v);
	void opSBC(Uint8 v);
	void opAND(Uint8 v);
	void opORA(Uint8 v);
	void opEOR(Uint8 v);
	void opBIT(Uint8 v);

	void opINC(Uint16 address, Uint8 repeatTimes);
	void opDEC(Uint16 address, Uint8 repeatTimes);
	void opINX(Uint8 repeatTimes);
	void opDEX(Uint8 repeatTimes);
	void opINY(Uint8 repeatTimes);
	void opDEY(Uint8 repeatTimes);

	void opASL_A(Uint8 repeatTimes);
	void opASL_M(Uint16 address, Uint8 repeatTimes);
	void opLSR_A(Uint8 repeatTimes);
	void opLSR_M(Uint16 address, Uint8 repeatTimes);
	void opROL_A(Uint8 repeatTimes);
	void opROL_M(Uint16 address, Uint8 repeatTimes);
	void opROR_A(Uint8 repeatTimes);
	void opROR_M(Uint16 address, Uint8 repeatTimes);
	void opCMP(Uint8 v1, Uint8 v2);

	void setLoadFlag(Uint8 v);

	std::vector<callStackEntry> callStack;
	void pushAddress(Uint16 address);
	void pushManualAddress(Uint16 address);
	void popAddress();
	void popIRAddress();
	bool handleReturnAddress(Uint16 address, Uint16 expectedAddress);

	void pushStatus();
	void popStatus();
	void opPLA();
	void opPHA();

	void wait(Uint8 type);
	void signal();

	void repeat();
	void brk();

	bool needWaitScanline;
	Uint8 waitScanline;
	void atScanline(Uint8 scanline);

	void atSprite0Hit();

	void SUB_00000A();
	void SUB_000052();
	void SUB_0000C2();
	void SUB_0000D2();
	void SUB_0000D6();
	void SUB_0000E1();
	void SUB_0000EF();
	void SUB_000110();
	void SUB_000112();
	void SUB_00011C();
	void SUB_000134();
	void SUB_000135();
	void SUB_000141();
	void SUB_00015A();
	void SUB_00016E();
	void SUB_00017B();
	void SUB_000187();
	void SUB_0002B5();
	void SUB_0002BF();
	void SUB_000347();
	void SUB_000352();
	void SUB_000383();
	void SUB_00038A();
	void SUB_0003D3();
	void SUB_0003E4();
	void SUB_000478();
	void SUB_00047D();
	void SUB_000562();
	void SUB_0005C2();
	void SUB_0006E4();
	void SUB_000743();
	void SUB_000755();
	void SUB_00076B();
	void SUB_01934C();
	void SUB_019380();
	void SUB_0193C5();
	void SUB_0193D9();
	void SUB_019458();
	void SUB_019479();
	void SUB_01947D();
	void SUB_019482();
	void SUB_019511();
	void SUB_019539();
	void SUB_019578();
	void SUB_019583();
	void SUB_019586();
	void SUB_0195E4();
	void SUB_019605();
	void SUB_01962C();
	void SUB_01962D();
	void SUB_01965B();
	void SUB_01970B();
	void SUB_01971D();
	void SUB_019720();
	void SUB_019757();
	void SUB_01977A();
	void SUB_01977B();
	void SUB_019782();
	void SUB_0197A7();
	void SUB_0197AA();
	void SUB_0197EA();
	void SUB_0197EB();
	void SUB_0197F2();
	void SUB_019809();
	void SUB_01989A();
	void SUB_0198AA();
	void SUB_0198AB();
	void SUB_0198F3();
	void SUB_0198FE();
	void SUB_01990A();
	void SUB_01990B();
	void SUB_01991F();
	void SUB_019938();
	void SUB_019944();
	void SUB_019967();
	void SUB_019998();
	void SUB_0199F0();
	void SUB_019A1D();
	void SUB_019A28();
	void SUB_019A2A();
	void SUB_019A5B();
	void SUB_019A62();
	void SUB_019A64();
	void SUB_019A69();
	void SUB_019A6B();
	void SUB_019A71();
	void SUB_019AE0();
	void SUB_019AE1();
	void SUB_019AF8();
	void SUB_019B1E();
	void SUB_019B7C();
	void SUB_019B89();
	void SUB_019BBA();
	void SUB_019BE3();
	void SUB_019C10();
	void SUB_019C43();
	void SUB_019C6D();
	void SUB_019C6F();
	void SUB_019CBD();
	void SUB_019D96();
	void SUB_019DC0();
	void SUB_019DC1();
	void SUB_019E2C();
	void SUB_019E3C();
	void SUB_019E4C();
	void SUB_019E5E();
	void SUB_019E70();
	void SUB_019ECB();
	void SUB_019ECE();
	void SUB_019F56();
	void SUB_019F60();
	void SUB_019F7A();
	void SUB_019FE7();
	void SUB_019FF3();
	void SUB_01A011();
	void SUB_01A037();
	void SUB_01A048();
	void SUB_01A08A();
	void SUB_01A0CD();
	void SUB_01A169();
	void SUB_01A17D();
	void SUB_01A1D0();
	void SUB_01A1E5();
	void SUB_01A206();
	void SUB_01A233();
	void SUB_01A23A();
	void SUB_01A23B();
	void SUB_01A296();
	void SUB_01A2AF();
	void SUB_01A2E8();
	void SUB_01A30D();
	void SUB_01A333();
	void SUB_01A353();
	void SUB_01A357();
	void SUB_01A35C();
	void SUB_01A38D();
	void SUB_01A824();
	void SUB_01A825();
	void SUB_01A919();
	void SUB_01A989();
	void SUB_01A9BD();
	void SUB_01A9E1();
	void SUB_01A9F1();
	void SUB_01AA0B();
	void SUB_01AA57();
	void SUB_01AAE1();
	void SUB_01AAE2();
	void SUB_01AB83();
	void SUB_01ABD6();
	void SUB_01ABDB();
	void SUB_01AC10();
	void SUB_01AC15();
	void SUB_01AC4F();
	void SUB_01AC54();
	void SUB_01AC70();
	void SUB_01AD4F();
	void SUB_01AD68();
	void SUB_01AD74();
	void SUB_01AD79();
	void SUB_01AD8D();
	void SUB_01AE2B();
	void SUB_01AE73();
	void SUB_01AE87();
	void SUB_01AE8C();
	void SUB_01B7DC();
	void SUB_01B823();
	void SUB_01B858();
	void SUB_01B859();
	void SUB_01B8D2();
	void SUB_01B911();
	void SUB_01B99D();
	void SUB_01B9C3();
	void SUB_01B9D6();
	void SUB_01B9FC();
	void reset();
	void nmi();
	void SUB_01C0B9();
	void SUB_01C0C0();
	void SUB_01C0D7();
	void SUB_01C0F7();
	void SUB_01C102();
	void SUB_01C10D();
	void SUB_01C11F();
	void SUB_01C132();
	void SUB_01C13F();
	void SUB_01C14B();
	void SUB_01C16D();
	void SUB_01C176();
	void SUB_01C18E();
	void SUB_01C19B();
	void SUB_01C1A7();
	void SUB_01C1CF();
	void SUB_01C1D4();
	void SUB_01C1D6();
	void SUB_01C1D8();
	void SUB_01C1E4();
	void SUB_01C216();
	void SUB_01C229();
	void SUB_01C232();
	void SUB_01C282();
	void SUB_01C28E();
	void SUB_01C299();
	void SUB_01C2DE();
	void SUB_01C32C();
	void SUB_01C363();
	void SUB_01C365();
	void SUB_01C368();
	void SUB_01C371();
	void SUB_01C373();
	void SUB_01C37A();
	void SUB_01C382();
	void SUB_01C474();
	void SUB_01C4A4();
	void SUB_01C4A8();
	void SUB_01C4AA();
	void SUB_01C4E7();
	void SUB_01C52C();
	void SUB_01C55D();
	void SUB_01C575();
	void SUB_01C57B();
	void SUB_01C582();
	void SUB_01C59C();
	void SUB_01C5B0();
	void SUB_01C5CF();
	void SUB_01C8C3();
	void SUB_01C8CD();
	void SUB_01C903();
	void SUB_01C90D();
	void SUB_01C917();
	void SUB_01C91C();
	void SUB_01C95D();
	void SUB_01C966();
	void SUB_01C98A();
	void SUB_01C994();
	void SUB_01C998();
	void SUB_01C9EA();
	void SUB_01CA38();
	void SUB_01CA6D();
	void SUB_01CA8B();
	void SUB_01CA95();
	void SUB_01CAA1();
	void SUB_01CAAF();
	void SUB_01CAE3();
	void SUB_01CAE7();
	void SUB_01CB11();
	void SUB_01CB39();
	void SUB_01CB56();
	void SUB_01CB81();
	void SUB_01CB83();
	void SUB_01CBCF();
	void SUB_01CC3D();
	void SUB_01CC5F();
	void SUB_01CC68();
	void SUB_01CC75();
	void SUB_01CC7A();
	void SUB_01CC95();
	void SUB_01CCA0();
	void SUB_01CCEE();
	void SUB_01CCF0();
	void SUB_01CCF2();
	void SUB_01CCF6();
	void SUB_01CED0();
	void SUB_01CF28();
	void SUB_01CF50();
	void SUB_01CF52();
	void SUB_01CF53();
	void SUB_01CFA1();
	void SUB_01CFBD();
	void SUB_01CFF9();
	void SUB_01D015();
	void SUB_01D01A();
	void SUB_01D025();
	void SUB_01D052();
	void SUB_01D09A();
	void SUB_01D10E();
	void SUB_01D11B();
	void SUB_01D120();
	void SUB_01D132();
	void SUB_01D162();
	void SUB_01D195();
	void SUB_01D196();
	void SUB_01D1BE();
	void SUB_01DA44();
	void SUB_01DA5F();
	void SUB_01DC50();
	void SUB_01DD14();
	void SUB_01DD3D();
	void SUB_01DEDC();
	void SUB_01DF06();
	void SUB_01DF0E();
	void SUB_01DF79();
	void SUB_01E09A();
	void SUB_01E0E2();
	void SUB_01E0E4();
	void SUB_01E0E9();
	void SUB_01E0F4();
	void SUB_01E109();
	void SUB_01E3F4();
	void SUB_01E3FF();
	void SUB_01E4CC();
	void SUB_01E4D9();
	void SUB_01E8F0();
	void SUB_01E915();
	void SUB_01E922();
	void SUB_01E924();
	void SUB_01E92B();
	void SUB_01E931();
	void SUB_01EA72();
	void SUB_01EA77();
	void SUB_01EA80();
	void SUB_01EAA9();
	void SUB_01EAB2();
	void SUB_01EAB8();
	void SUB_01EABD();
	void SUB_01EACB();
	void SUB_01EADD();
	void SUB_01EB08();
	void SUB_01EB6A();
	void SUB_01EC60();
	void SUB_01EC72();
	void SUB_01EF04();
	void SUB_01EF84();
	void SUB_01F131();
	void SUB_01F1DB();
	void SUB_01F34D();
	void SUB_01F376();
	void SUB_01F41F();
	void SUB_01F42C();
	void SUB_01F4BE();
	void SUB_01F5EA();
	void SUB_01F60F();
	void SUB_01F62D();
	void SUB_01F68C();
	void SUB_01F699();
	void SUB_01F69E();
	void SUB_01F7ED();
	void SUB_01F817();
	void SUB_01F841();
	void SUB_01F868();
	void SUB_01F87C();
	void SUB_01F87D();
	void SUB_01F909();
	void SUB_01F912();
	void SUB_01F918();
	void SUB_01F94F();
	void SUB_01F972();
	void SUB_01F99B();
	void SUB_01F9A0();
	void SUB_01F9D4();
	void SUB_01FA26();
	void SUB_01FA6A();
	void SUB_01FA8E();
	void SUB_01FAEF();
	void SUB_01FB05();
	void SUB_01FB06();
	void SUB_01FC97();
	void SUB_01FCB9();
	void SUB_01FCD0();
	void SUB_01FD18();
	void SUB_01FD23();
	void SUB_01FD7E();
	void SUB_01FE96();
	void SUB_01FEB3();
	void jump(Uint16 target);

};

